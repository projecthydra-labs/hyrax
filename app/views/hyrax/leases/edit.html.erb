<% cc_type = @change_set.human_readable_type %>

<% provide :page_header do %>
  <h1><%= t('.manage_leases_html', cc: @change_set.to_s, cc_type: cc_type) %></h1>
<% end %>

<h2><%= t('.header.current') %></h2>
<%= simple_form_for @change_set, url: [main_app, @change_set.parent_resource] do |f| %>
  <fieldset class="set-access-controls">
    <section class="help-block">
      <p>
        <% if @change_set.lease_expiration_date %>
          <%= t('.lease_true_html',  cc: cc_type) %>
        <% else %>
          <%= t('.lease_false_html', cc: cc_type) %>
        <% end %>
      </p>
    </section>

    <div class="form-group">
      <input type="hidden" name="<%= f.object_name %>[visibility]" value="<%= Hydra::AccessControls::AccessRight::VISIBILITY_TEXT_VALUE_LEASE %>" />
      <%= render 'hyrax/base/form_permission_lease', f: f  %>
    </div>
  </fieldset>

  <div class="row">
    <div class="col-md-12 form-actions">
      <% if @change_set.lease_expiration_date %>
        <%= f.submit t('.lease_update'), class: 'btn btn-primary' %>
        <%= link_to t('.lease_deactivate'), lease_path(@change_set.parent_resource), method: :delete, class: 'btn btn-danger' %>
      <% else %>
        <%= f.submit t('.lease_apply'), class: 'btn btn-primary' %>
      <% end %>
      <%= link_to t('.lease_cancel'), leases_path, class: 'btn btn-default' %>
      <%= link_to t('.lease_return', cc: cc_type), edit_polymorphic_path([main_app, @change_set.parent_resource]), class: 'btn btn-default' %>
    </div>
  </div>
<% end %>

<h2><%= t('.header.past') %></h2>
<% if @change_set.lease_history.empty? %>
  <%= t('.history_empty', cc: cc_type) %>
<% else %>
  <%= render partial: 'lease_history', object: @change_set.lease_history %>
<% end %>
